# Заголовок
Architecture of Game Projects Using Third Person Shooter as an Example
Архитектура Игровых Проектов на Примере Шутера от Третьего Лица

# Подзаголовок
Shooter Game Tutorial | Game Architecture | Modular Architecture | Clean Architecture | Domain-Driven Design | State-Driven UI | Best Practices
Учебное пособие по игре-шутеру | Архитектура игр | Модульная архитектура | Чистая архитектура | Domain-Driven Дизайн | State-Driven Пользовательский Интерфейс | Лучшие Практики

# Обзор
В этом видео курсе мы подробно рассмотрим пример шутера, в котором я постарался воплотить все свои лучшие идеи и наработки, накопленные за годы работы в игровой индустрии.
Заметьте, я не буду углубляться в детали устройства движка Unity, так как предполагается, что у вас уже есть базовые знания об этом движке.
Вместо этого, я сосредоточусь на главных принципах разработки качественных проектов.
Эти знания будут вам полезны не только для работы с Unity, но и в других сферах программирования.
Также мы рассмотрим некоторые дополнительные пакеты и инструменты, которые значительно упростили разработку основного проекта.

В этом курсе:
- Мы подробно рассмотрим наш пример шутера и все дополнительные пакеты.
- Мы рассмотрим самые важные принципы разработки качественных проектов.
- Вы узнаете как организовать удобную структуру проекта.
- Вы узнаете как спроектировать качественную и модульную архитектуру проекта.
- Вы узнаете что такое Clean Architecture, Domain-Driven Design, View-Driven и State-Driven UI.
- Вы узнаете как написать для UIToolkit красивую тему стилей.
- Вы узнаете как расширить редактор Unity, чтобы повысить удобство и продуктивность рабочего процесса.
- Вы получите доступ к проекту и сможете использовать его в качестве шаблона для ваших проектов.
- Вы получите доступ ко всем дополнительным пакетам, которые вы сможете использовать в ваших проектах.

Приятного просмотра!

# Справка
Проект состоит из модулей:
- Project
- Project.UI
- Project.UI.Internal
- Project.App
- Project.Entities
- Project.Entities.Actors
- Project.Entities.Things
- Project.Entities.Worlds
- Project.Infrastructure

А так же проект имеет несколько зависимостей:
- Clean Architecture Game Framework - Архитектурный фреймворк.
- Addressables Extensions           - Библиотека для работы с ассетами.
- Addressables Source Generator     - Инструмент для генерации всех адресов и меток ассетов.
- Colorful Project Window           - Расширения для окна проекта, делающее рабочий процесс более удобным.
- UIToolkit Theme Style Sheet       - Тема стилей для UI Toolkit.

# Ссылки
- https://github.com/Denis535/UnityShooterExample
- https://openupm.com/packages/?sort=downloads&q=denis535
- https://assetstore.unity.com/packages/tools/gui/uitoolkit-theme-style-sheet-273463


########## ########## ########## ########## ########## ########## ########## ########## ########## ##########


# 1. Введение
В этом видео курсе мы подробно рассмотрим пример шутера, в котором я постарался воплотить все свои лучшие идеи и наработки, накопленные за годы работы в игровой индустрии.
Заметьте, я не буду углубляться в детали устройства движка Unity, так как предполагается, что у вас уже есть базовые знания об этом движке.
Вместо этого, я сосредоточусь на главных принципах разработки качественных проектов.
Эти знания будут вам полезны не только для работы с Unity, но и в других сферах программирования.
Также мы рассмотрим некоторые дополнительные пакеты и инструменты, которые значительно упростили разработку основного проекта.

После просмотра данного курса:
- Вы узнаете все детали устройства нашего пример шутера и дополнительных пакетов.
- Вы узнаете самые важные принципы разработки качественных проектов.
- Вы узнаете как организовать удобную структуру проекта.
- Вы узнаете как спроектировать качественную и модульную архитектуру проекта.
- Вы узнаете что такое Clean Architecture, Domain-Driven Design, View-Driven и State-Driven UI.
- Вы узнаете как написать для UIToolkit красивую тему стилей.
- Вы узнаете как расширить редактор Unity, чтобы повысить удобство и продуктивность рабочего процесса.
- Вы получите доступ к проекту и сможете использовать его в качестве шаблона для ваших проектов.
- Вы получите доступ ко всем дополнительным пакетам, которые вы сможете использовать в ваших проектах.

Приятного просмотра!

# 2. Структура проекта
В этом видео мы подробно рассмотрим принципы организации удобной структуры проекта.

Наш проект включает в себя несколько основных модулей, а также один дополнительный модуль.
Все основные модули находятся в папке Project.Assemblies.
Но обратите внимание, что эта папка содержит только asmdef файлы.
А все исходники и ассеты находятся в папке Project.
Красная папка Project содержит зеленные и желтые папки.
Зеленные папки содержат исходники, а их имена отражают пространства имен этих исходников.
Желтые папки содержат ассеты, а их имена отражают адреса этих ассетов.
Обратите внимание, что все папки с исходниками так же содержат asmref файлы, которые определяют к какому модулю относятся эти исходники.
Так же есть еще один дополнительный модуль для инфраструктуры.
Этот модуль не является частью проекта, а является частью одноименного пакета.
В нем я спрятал все общее, разные утилиты, хелперы и просто весь низкоуровневый мусор.
В результате такой структуры, проект получается простым и удобным.
Все основные исходники и ассеты всегда у вас под рукой.
А все второстепенное спрятано от глаз.

Благодаря этим принципам, команда разработчиков может сосредоточить свое внимание на основных деталях проекта и меньше думать о второстепенных.
Что в свою очередь повышает эффективность разработки и поддержки проекта.

# 3. Архитектура проекта
В этом видео мы подробно рассмотрим принципы организации качественной архитектуры проекта.

Наш проект использует такие парадигмы как: чистая архитектура, domain-driven дизайн и state-driven пользовательский интерфейс.
Эти парадигмы четко и ясно определяют архитектуру нашего проекта.

Давайте рассмотрим их подробнее:
- Чистая архитектура - это идея, что весь проект состоит из первостепенных и второстепенных модулей, с конкретными ответственностями и зависимостями.
  То есть все самое важное очищено от разного мусора.
  Например, главный модуль содержит все самое важное.
  А внутренний модуль содержит всю инфраструктуру необходимую для главного модуля.
  При необходимости можно создать еще модули, дополняющие главный модуль.
  В более сложных случаях можно использовать инверсию зависимостей, чтобы главный модуль не зависел напрямую от некой сложной инфраструктуры, а зависел косвенно через простые абстракции.
  В итоге получается, что главный модуль становится максимально простым и чистым.

- Domain-driven дизайн - это идея, что сердцем проекта являются сущности, выполняющие бизнес задачи нашего приложения, и в идеале, отражающие объекты реального мира.
  То есть модуль предметной области является первичным и абсолютно независимым от других модулей.
  А другие модули разрабатывается для обеспечения функционирования нашей предметной области.
  В итоге получается, что модуль предметной области так же становится максимально простым и чистым.
  А его разработка не зависит от других модулей.
  
- View-driven ui - это идея, что пользовательский интерфейс представляется деревом визуальных элементов.
  Такая архитектура хорошо подходит для обычных оконных приложений.
  В таких приложениях, все элементы пользовательского интерфейса расположены в главном окне.
  А если что-то не уместилось в главном окне, то пользователь может открывать дополнительные окна.
  Но для некоторых случаев этого недостаточно...

- State-driven ui - это идея, что пользовательский интерфейс представляется деревом состояний и деревом визуальных элементов.
  То есть дерево состояний является первичным и абсолютно независимым от дерева визуальных элементов.
  Каждое состояние может иметь (или не иметь) свое визуальное представление.
  Мы можем добавлять новые ноды в дерево состояний.
  Или мы можем удалять ноды и даже целые ветки из дерева состояний.
  В итоге мы можем элегантно делать сложные пользовательские интерфейсы и сложные навигации между разными состояниями.
  Такая архитектура хорошо подходит для полноэкранных приложений, таких как мобильные приложения или игры.
  В таких приложениях, в один момент времени, пользовательский интерфейс может находится лишь в одном или нескольких состояниях.
  А пользователь может перемещаться по пользовательскому интерфейсу, переключая эти состояния одни на другие.

Благодаря этим принципам, код получается более простым, однообразным, логичным и понятным.
А команда разработчиков может сосредоточить свое внимание на решении бизнес задач и меньше думать об архитектурных проблемах.
Что в свою очередь повышает эффективность разработки и поддержки проекта.

# 4. Модуль Project
В этом видео мы рассмотрим модуль Project.
Это самый главный модуль, который отвечает за запуск приложения, обработку событий, разрешение зависимостей, а так же содержит некоторые инструменты.
Так же этот модуль содержит все сцены, кроме уровней.

Теперь давайте рассмотрим ассеты:
- Launcher - это дефолтная сцена, которая загружается самой первой, и в свою очередь, загружает главную сцену Startup.
  Обратите внимание, что движок требует, чтобы дефолтная сцена была встроена в сам билд проекта.
  Поэтому мы должны загружать сначала дефолтную сцену Launcher. 
  А потом загружать из бандлов любые другие сцены.
- Startup - это главная сцена, которая загружена на протяжении всего жизненного цикла приложения.
  Она содержит все singleton объекты нашего приложения.
- MainScene - это сцена, которая загружается вместе с главным меню.
  В нашем случае эта сцена абсолютно пустая.
- GameScene - это сцена, которая загружается вместе с игрой.
  В нашем случае эта сцена так же абсолютно пустая.

Теперь давайте рассмотрим исходный код:
- Launcher - это скрипт, который просто загружает из бандлов главную сцену Startup.
- Program - это главный класс приложения, отвечающий за инициализацию, обработку событий и разрешение зависимостей.
- DebugScreen - это отладочный экран, показывающий некоторую полезную информацию на экране.
- ProjectToolbar - это набор разных полезные инструментов, которые упрощают работу с проектом. 
- ProjectWindow - это более удобное окно проекта, которое упрощаат работу с проектом.
  В следующих видео мы поговорим об этом подробнее.

# 5. Модуль Project.UI
В этом видео мы рассмотрим модуль Project.UI.
Данный модуль отвечает за пользовательский интерфейс нашего приложения.
Обратите внимание, что наш пользовательский интерфейс состоит из нескольких неймспейсов:
- Project.UI            - содержит тему, экран и роутер.
- Project.UI.MainScreen - содержит все виджеты главного экрана.
- Project.UI.GameScreen - содержит все виджеты игрового экрана.
- Project.UI.Common     - содержит все общие виджеты. 
А так же, обратите внимание, что модуль разделен на две части:
- Project.UI            - содержит тему, экран, роутер и виджеты.
- Project.UI.Internal   - содержит вьюшки.
Благодаря такому подходу, вьюшки не имеют зависимостей на другие модули.

Теперь давайте рассмотрим исходный код:
- UITheme - это аудио тема нашего приложения.
  Тема использует паттерн состояние, что позволяет нам легко переключаться между разными плейлистами.
- PlayList, MainPlayList и GamePlayList - это музыкальные плейлисты нашей темы.

- UIScreen - это графический пользовательский интерфейс нашего приложения.
  Экран использует state-driven архитектуру, что позволяет нам создавать пользовательский интерфейс из множества разных виджетов и легко переключаться между ними.
  Я рассказывал об этой архитектуре в одном из прошлых видео.
- RootWidget - это корневой виджет нашего экрана.
  Этот виджет добавляет другие виджеты в дерево визуальных элементов.

- UIRouter - это менеджер нашего приложения.
  Этот менеджер предоставляет методы для управления нашим приложением.
  Такие как загрузить, перезагрузить и выгрузить игру, а так же выйти из приложения.

- MainWidget - это виджет главного экран.
  Этот виджет показывает главное меню.
  Или если произошла ошибка, то виджет показывает сообщение об этой ошибки.
- MenuWidget - это виджет главного меню.
  Главное меню состоит из нескольких подменю, которые добавляются и удаляются, когда пользователь взаимодействует с ними.

- GameWidget - это виджет игрового экрана.
  Этот виджет показывает информацию об игре.
  Или если игрок нажал на паузу, то виджет показывает игровое меню.
- MenuWidget - это виджет игрового меню.
- TotalsWidget - это виджет итогов игры.
  Итоги могут быть трех типов: уровень проигран, уровень пройден и игра пройдена.

- LoadingWidget - это виджет загрузки и перезагрузки игры.
- UnloadingWidget - это виджет выгрузки игры.
- SettingsWidget - это виджет настроек.
  Точнее этот виджет является лишь контейнером для других виджетов, которые содержат настройки.
- ProfileSettingsWidget - это виджет настроек профиля.
- VideoSettingsWidget - это виджет настроек графики.
- AudioSettingsWidget - это виджет настроек звука.
- DialogWidget, InfoDialogWidget, WarningDialogWidget, ErrorDialogWidget - это виджеты диалогов разных стилей.

- Вьюшки - это просто визуальные элементы.

Теперь давайте рассмотрим ассеты:
- PanelSettings - это настройки UItoolkit.
- ThemeStyleSheet - это таблица стилей темы.
- Так же модуль содержит и другие ресурсы необходимые для стилей.

# 6. Модуль Project.App
В этом видео мы рассмотрим модуль Project.App.
Данный модуль отвечает за все необходимое для работы самого приложения.

Теперь давайте рассмотрим исходный код:
- Application - это класс, содержащий все сущности и сервисы нашего приложения.
- Storage, ProfileSettings, VideoSettings, AudioSettings - это классы, которые предоставляют значения, полученные из аргументов командной строки или загруженные из хранилища.

# 7. Модуль Project.Entities
В этом видео мы рассмотрим модуль Project.Entities.
Данный модуль отвечает за нашу предметную область, то есть содержит все сущности нашей игры.
Обратите внимание, что наша предметная область состоит из нескольких модулей:
- Project.Entities        - содержит базовые сущности, такие как игра, игрок, камера или игровой дисплей (HUD).
- Project.Entities.Actors - содержит все действующие сущности, которые могут действовать самостоятельно или под управлением игрока.
- Project.Entities.Things - содержит все вещи, которыми актеры могут владеть.
- Project.Entities.Worlds - содержит все объекты окружения и сами миры.
Так же, при необходимости, можно было бы добавить модуль для транспортных средств.

Теперь давайте рассмотрим исходный код:
- GameBase3 и Game - это классы, который содержит состояние игры, объекты представляющие реальных игроков, а так же реализует все игровые правила.
- PlayerBase3 и Player - это класс, который содержит состояние игрока, персонажа и камеру.
- Camera2 - это сущность камеры, которая следует за игровым персонажем.
  Эта сущность обрабатывает пользовательский ввод и всегда следует за персонажем, будь он жив или мертв.

- CharacterBase - это базовая сущность для всех игровых и не игровых персонажей.
  Эта сущность содержит методы, которые позволяют управлять персонажем как пешкой.
- PlayableCharacterBase - это базовая сущность для всех играбельных персонажей.
- NonPlayableCharacterBase - это базовая сущность для всех не играбельных персонажей.
- PlayerCharacter - это сущность играбельного персонажа.
  Эта сущность просто обрабатывает пользовательский ввод.
- EnemyCharacter - это сущность вражеского персонажа.
  Эта сущность реализует простейший искусственный интеллект.

- WeaponBase - ...
- Gun - это сущность пистолета, которая предоставляет метод для стрельбы.
- Bullet - это сущность пули, которая при столкновении наносит урон персонажу.

- World - это сущность мира, которая предоставляет нам все статические объекты мира.

Теперь давайте рассмотрим ассеты:
...

# 8. Модуль Project.Infrastructure

